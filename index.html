<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Visual Novel Engine</title>
  <style>
    :root{
      --max-width:900px;
      --ui-pad:20px;
      --textbox-bg: rgba(0,0,0,0.65);
      --textbox-color:#fff;
      --font: system-ui, -apple-system, "Segoe UI", Roboto, Arial;
    }html,body{
  margin:0;
  height:100%;
  background:#000;
  font-family:var(--font);
  color:var(--textbox-color);
}

.wrap{
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  padding:24px;
  box-sizing:border-box;
}

#game{
  width:100%;
  max-width:var(--max-width);
  display:flex;
  flex-direction:column;
  gap:12px;
}

/* STAGE */
#stage{
  position:relative;
  width:100%;
  aspect-ratio:16/9;
  background:#111;
  overflow:hidden;
  border-radius:12px;
}

#background{
  position:absolute;
  inset:0;
  width:100%;
  height:100%;
  object-fit:cover;
  z-index:0;
}

.sprite{
  position:absolute;
  bottom:0;
  max-height:100%;
  user-select:none;
  pointer-events:none;
  transition:opacity .3s, transform .3s;
}

.left{
  left:2%;
  transform:translateX(0);
}

.right{
  right:2%;
  transform:translateX(0);
}

.hidden{
  opacity:0;
}

/* TEXTBOX */
#textbox{
  background:var(--textbox-bg);
  padding:var(--ui-pad);
  border-radius:12px;
  font-size:20px;
  line-height:1.4;
  min-height:80px;
  cursor:pointer;
}

#textbox .caret{
  display:inline-block;
  width:10px;
  height:1.1em;
  background:#fff;
  margin-left:6px;
  animation:blink 1s steps(1) infinite;
}

@keyframes blink{50%{opacity:0}}

/* CHOICES */
#choices{
  display:none;
  flex-direction:column;
  gap:8px;
}

.choice{
  background:#fff;
  color:#000;
  padding:12px;
  border-radius:10px;
  cursor:pointer;
  text-align:center;
  font-size:18px;
}

.choice:active{transform:translateY(1px)}

  </style>
</head>
<body>
  <div class="wrap">
    <div id="game">
      <div id="stage">
        <img id="background" src="" alt="background" />
        <img id="spriteLeft" class="sprite left hidden" src="https://cdn.discordapp.com/attachments/1417112659937067102/1461797407669882880/IMG-20260117-WA0002.jpg?ex=696bdc6c&is=696a8aec&hm=ea7042bb3f389b50f0c225e7579eeebe1970b9d9cd1d9ca6fec1a0889df353f6&.jpg" alt="left sprite" />
        <img id="spriteRight" class="sprite right hidden" src="https://cdn.discordapp.com/attachments/1417112659937067102/1461796324121776128/IMG-20260117-WA0000.jpg?ex=696bdb6a&is=696a89ea&hm=0385b4a4d28afedf8703536c6ce04f5cf16db8a52b1a9e2dab99a8ccecd6a665&.jpg" alt="right sprite" />
      </div><div id="textbox" tabindex="0"></div>
  <div id="choices"></div>
</div>

  </div><script>
  const textbox = document.getElementById('textbox');
  const choicesBox = document.getElementById('choices');
  const bg = document.getElementById('background');
  const leftSprite = document.getElementById('spriteLeft');
  const rightSprite = document.getElementById('spriteRight');

  let typing=false, timer=null, currentText="";
  const speed=28;

  /* ===== ENGINE API ===== */
  function setBackground(src){ bg.src = src || ""; }

  function setLeftSprite(src){
    if(src){ leftSprite.src=src; leftSprite.classList.remove('hidden'); }
    else leftSprite.classList.add('hidden');
  }

  function setRightSprite(src){
    if(src){ rightSprite.src=src; rightSprite.classList.remove('hidden'); }
    else rightSprite.classList.add('hidden');
  }

  function clearChoices(){ choicesBox.innerHTML=""; choicesBox.style.display='none'; }

  function showChoices(list){
    clearChoices();
    choicesBox.style.display='flex';
    list.forEach(c=>{
      const btn=document.createElement('div');
      btn.className='choice';
      btn.textContent=c.text;
      btn.onclick=c.onSelect;
      choicesBox.appendChild(btn);
    });
  }

  function typeText(text,onDone=()=>{}){
    typing=true;
    currentText=text;
    textbox.innerHTML="";
    const span=document.createElement('span');
    const caret=document.createElement('span');
    caret.className='caret';
    textbox.append(span,caret);
    let i=0;
    clearInterval(timer);
    timer=setInterval(()=>{
      span.textContent+=text[i]||"";
      i++;
      if(i>=text.length){
        clearInterval(timer);
        typing=false;
        span.textContent=text;
        onDone();
      }
    },speed);
  }

  function skipTyping(){
    if(!typing) return;
    clearInterval(timer);
    typing=false;
    textbox.innerHTML=currentText+'<span class="caret"></span>';
  }

  textbox.onclick=()=>{ if(typing) skipTyping(); };

  /* Expose helpers for your story logic */
  window.VN={
    setBackground,
    setLeftSprite,
    setRightSprite,
    typeText,
    showChoices,
    clearChoices
  };

  /* ===== STORY SCRIPT ===== */
  let scene = 0;

  function nextScene(){ scene++; runScene(); }

  function runScene(){
    VN.clearChoices();

    switch(scene){
      case 0:
        VN.setBackground("https://cdn.pixabay.com/photo/2016/11/29/04/15/room-1867727_1280.jpg");
        VN.setLeftSprite(null);
        VN.setRightSprite(null);
        VN.typeText("You enter a dimly lit room. Everything seems quiet.", nextScene);
        break;
      case 1:
        VN.typeText("A soft voice calls from the corner.", nextScene);
        break;
      case 2:
        VN.setLeftSprite("https://cdn.discordapp.com/attachments/1417112659937067102/1461797407669882880/IMG-20260117-WA0002.jpg?ex=696bdc6c&is=696a8aec&hm=ea7042bb3f389b50f0c225e7579eeebe1970b9d9cd1d9ca6fec1a0889df353f6&.jpg");
        VN.typeText("Girl: Hello… I’ve been waiting for you.", nextScene);
        break;
      case 3:
        VN.showChoices([
          { text: "Who are you?", onSelect: ()=>{scene=4; runScene();} },
          { text: "Ignore her", onSelect: ()=>{scene=7; runScene();} }
        ]);
        break;
      case 4:
        VN.typeText("Girl: Does it really matter? You found me anyway.", nextScene);
        break;
      case 5:
        VN.setRightSprite("https://cdn.discordapp.com/attachments/1417112659937067102/1461796324121776128/IMG-20260117-WA0000.jpg?ex=696bdb6a&is=696a89ea&hm=0385b4a4d28afedf8703536c6ce04f5cf16db8a52b1a9e2dab99a8ccecd6a665&.jpg");
        VN.typeText("Boy: Don’t be scared. We’re not alone here.", nextScene);
        break;
      case 6:
        VN.typeText("The two of them step closer, and the room feels alive.", nextScene);
        break;
      case 7:
        VN.typeText("You ignore her. The voice fades. Silence returns.", nextScene);
        break;
      case 8:
        VN.setLeftSprite(null);
        VN.setRightSprite(null);
        VN.typeText("The room is empty again. Was it real?", ()=>{});
        break;
    }
  }

  /* Start story */
  runScene();
</script></body>
</html>